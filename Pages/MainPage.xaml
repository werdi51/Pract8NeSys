<Page x:Class="_7.Pages.MainPage"
      xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
      xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
      Title="Главная страница" 
      Loaded="Page_Loaded"
      >

    <Page.Resources>
        
        <Style TargetType="TextBlock" x:Key="Vertical">
            <Setter Property="FontSize" Value="14"/>
            <Setter Property="VerticalAlignment" Value="Center"/>
            <Setter Property="Foreground" Value="{DynamicResource TextColor}"/>
        </Style>

        <Style TargetType="TextBlock" x:Key="Info">
            <Setter Property="Width" Value="120"/>
            <Setter Property="Foreground" Value="{DynamicResource TextColor}"/>
        </Style>

        <Style TargetType="TextBlock" BasedOn="{StaticResource header}" x:Key="list">
            <Setter Property="HorizontalAlignment" Value="Center"/>
        </Style>

        <Style TargetType="StackPanel" BasedOn="{StaticResource HorisontalPanel}" x:Key="margin">
            <Setter Property="Margin" Value="0,5,0,0"/>
        </Style>

        <Style TargetType="StackPanel" x:Key="gray">
            <Setter Property="Background" Value="{DynamicResource BorderBackground}"/>
            <Setter Property="Orientation" Value="Horizontal"/>
        </Style>


        
        
    </Page.Resources>
    
    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="*"/>
            <ColumnDefinition Width="*"/>
        </Grid.ColumnDefinitions>

        <StackPanel Grid.Row="0" Style="{StaticResource HorisontalPanel}" Grid.ColumnSpan="2">
            <TextBlock Text="{Binding DoctorInfoString}" Style="{StaticResource Vertical}" />
            <Button Content="Выйти" Click="LogoutButton_Click" Style="{StaticResource ButtonExit}"/>
        </StackPanel>

        <Grid Grid.Row="1" Grid.Column="0">
            <StackPanel>
                <TextBlock Text="Информация о пациенте" Style="{StaticResource header}"/>

                <StackPanel>
                    <StackPanel Style="{StaticResource margin}">
                        <TextBlock Text="ID: " Style="{StaticResource Info}"/>
                        <TextBlock Text="{Binding SelectedPatient.Id}"/>
                    </StackPanel>

                    <StackPanel Style="{StaticResource margin}">
                        <TextBlock Text="Фамилия: " Style="{StaticResource Info}"/>
                        <TextBlock Text="{Binding SelectedPatient.LastName}"/>
                    </StackPanel>

                    <StackPanel Style="{StaticResource margin}" >
                        <TextBlock Text="Имя: " Style="{StaticResource Info}"/>
                        <TextBlock Text="{Binding SelectedPatient.Name}"/>
                    </StackPanel>

                    <StackPanel Style="{StaticResource margin}" >
                        <TextBlock Text="Отчество: " Style="{StaticResource Info}"/>
                        <TextBlock Text="{Binding SelectedPatient.MiddleName}"/>
                    </StackPanel>

                    <StackPanel Style="{StaticResource margin}" >
                        <TextBlock Text="Дата рождения: " Style="{StaticResource Info}"/>
                        <TextBlock Text="{Binding SelectedPatient.Birthday}"/>
                    </StackPanel>

                    <StackPanel Style="{StaticResource margin}" >
                        <TextBlock Text="Телефон: " Style="{StaticResource Info}"/>
                        <TextBlock Text="{Binding SelectedPatient.PhoneNumber}"/>
                    </StackPanel>
                </StackPanel>

                <StackPanel Style="{StaticResource HorisontalPanel}">
                    <Button Content="Начать прием" 
                            Click="StartAppointmentButton_Click" Style="{StaticResource ButtonStart}"
                            />
                    <Button Content="Изменить информацию" 
                            Click="EditPatientButton_Click" Style="{StaticResource ButtonChange}"
                           />
                    <Button Content="Удалить" 
                            Click="DeletePatientButton_Click"  Style="{StaticResource ButtonDelete}"
                           />
                </StackPanel>

                <TextBlock Text="История приёмов"/>

                <ListView ItemsSource="{Binding SelectedPatient.AppointmentStories}">
                    <ListView.ItemTemplate>
                        <DataTemplate>
                            <StackPanel>
                                <StackPanel Style="{StaticResource HorisontalPanel}">
                                    <TextBlock Text="Дата: " />
                                    <TextBlock Text="{Binding date}"/>
                                </StackPanel>
                                <StackPanel Style="{StaticResource HorisontalPanel}">
                                    <TextBlock Text="Диагноз: " />
                                    <TextBlock Text="{Binding Diagnosis}"/>
                                </StackPanel>
                                <StackPanel Style="{StaticResource HorisontalPanel}">
                                    <TextBlock Text="Рекомендации: " />
                                    <TextBlock Text="{Binding Recomendations}"/>
                                </StackPanel>
                                <StackPanel Style="{StaticResource HorisontalPanel}">
                                    <TextBlock Text="Врач ID: " />
                                    <TextBlock Text="{Binding doctor_id}"/>
                                </StackPanel>
                            </StackPanel>
                        </DataTemplate>
                    </ListView.ItemTemplate>
                </ListView>
            </StackPanel>
        </Grid>

        <Border Grid.Row="1" Grid.Column="1" >
            <StackPanel>
                <TextBlock Text="Список пациентов" Style="{StaticResource list}"/>
                <Button Content="Создать пациента" Click="CreatePatientButton_Click" Style="{StaticResource ButtonAdd}"/>

                <ListView ItemsSource="{Binding Patients}" 
                          SelectedItem="{Binding SelectedPatient}">
                    <ListView.ItemTemplate>
                        <DataTemplate>
                                <StackPanel>
                                    <TextBlock Text="{Binding LastName}"/>
                                    <TextBlock Text="{Binding Name}"/>
                                    <TextBlock Text="{Binding MiddleName}"/>
                                    <StackPanel Style="{StaticResource HorisontalPanel}">
                                        <TextBlock Text="ID: "/>
                                        <TextBlock Text="{Binding Id}"/>
                                    </StackPanel>
                                </StackPanel>
                        </DataTemplate>
                    </ListView.ItemTemplate>
                </ListView>
            </StackPanel>
        </Border>

        <StackPanel Grid.Row="2" Style="{StaticResource gray}" Grid.ColumnSpan="2">
            <StackPanel Orientation="Horizontal">
                <TextBlock Text="Докторов: "/>
                <TextBlock Text="{Binding DoctorsCount}" Style="{StaticResource header}"/>
            </StackPanel>

            <StackPanel Orientation="Horizontal">
                <TextBlock Text="Пациентов: "/>
                <TextBlock Text="{Binding PatientsCount}"  Style="{StaticResource header}"/>
            </StackPanel>
        </StackPanel>

        <StackPanel Grid.Row="2" Grid.Column="1">
            <Button Content="Сменить стиль" Click="Button_Click" Style="{StaticResource ButtonStart}"/>
        </StackPanel>
    </Grid>
</Page>